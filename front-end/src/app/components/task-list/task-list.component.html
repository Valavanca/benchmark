<div class="box">
  <!-- <mat-card class="focus" *ngIf=focus>
    <!- FOCUS task. select from lists ->
  
    <button mat-icon-button (click)="clearFocus()" class="focus-clear">
      <mat-icon>close</mat-icon>
    </button>
  
    <mat-card-title color="primary">ID: {{focus.id.substr(0, 5)}}</mat-card-title>
    <mat-tab-group>
      <mat-tab label="Result">
        <mat-list role="list">
          <mat-list-item role="listitem">
            <mat-icon>gradient</mat-icon>
            <span>Method: </span>
            <span> {{focus.run.method}}</span>
          </mat-list-item>
          <mat-list-item role="listitem">
            <mat-icon>whatshot</mat-icon>
            <span>Energy: </span>
            <span> {{focus.meta_data.result.energy}}</span>
          </mat-list-item>
          <mat-list-item role="listitem">
            <mat-icon>memory</mat-icon>
            <span>Frequency: </span>
            <span> {{focus.meta_data.result.frequency}}</span>
          </mat-list-item>
          <mat-list-item role="listitem">
            <mat-icon>layers</mat-icon>
            <span>Threads: </span>
            <span> {{focus.meta_data.result.threads}}</span>
          </mat-list-item>
          <mat-list-item role="listitem">
            <mat-icon>timer</mat-icon>
            <span>Time: </span>
            <span> {{ (focus.meta_data?.result.time > 0) ? (focus.meta_data.result.time | date: 'mm:ss') : ""}}</span>
          </mat-list-item>
        </mat-list>
      </mat-tab>
      <mat-tab label="Meta data">
        <mat-list role="list">
          <mat-list-item role="listitem">
            <mat-icon>rowing</mat-icon>
            <span>Worker:</span>
            <span>{{focus.meta_data.appointment}}</span>
          </mat-list-item>
          <mat-list-item role="listitem">
            <mat-icon>list</mat-icon>
            <span>Accept:</span>
            <span>{{ (focus.meta_data?.accept > 0) ? (focus.meta_data.accept | date: 'mm:ss') : ""}}</span>
          </mat-list-item>
          <mat-list-item role="listitem">
            <mat-icon>directions</mat-icon>
            <span>Receive:</span>
            <span>{{ (focus.meta_data?.receive > 0) ? (focus.meta_data.receive | date: 'mm:ss') : ""}}</span>
          </mat-list-item>
        </mat-list>
      </mat-tab>
    </mat-tab-group>
  </mat-card> -->
  <!-- end focus -->



    <!-- <mat-card class="stack">                                     
      <mat-card-header>
        <h3>Stack <span class="length">({{stack?.length}})</span></h3>
      </mat-card-header> 
      <mat-card-content>
        <mat-list dense role="list" *ngIf=stack>
          <mat-list-item *ngFor="let task of stack" 
            (click)="taskInfo(task.id)" role="listitem" 
            [class.selected]="task.id === this.focus?.id">
            <mat-icon matListIcon>folder</mat-icon>
            <h3 matLine> {{task.id.substr(0, 5)}} </h3>
            <p matLine>
              <span> {{task.run?.param?.frequency}} </span>
              <span class="demo-2"> -- {{task.run?.param?.threads}} </span>
            </p>
            <button mat-icon-button (click)="taskInfo(task.id)">
              <mat-icon>info</mat-icon>
            </button>
          </mat-list-item>
        </mat-list>
      </mat-card-content>
    </mat-card>  -->

    <!-- RESULT table -->
    <mat-card class="result">   
      <mat-card-header>
        <h3>Result <span class="length">({{result?.length}})</span></h3>
      </mat-card-header> 

      <mat-card-content>
        <mat-form-field>
          <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
        </mat-form-field>
        <div class="mat-elevation-z8" >
          <table mat-table #table [dataSource]="resultData" multiTemplateDataRows matSort>
        
            <!-- Id Column -->
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
              <td mat-cell *matCellDef="let task"> {{task?.id?.toString().substr(0, 5)}} </td>
            </ng-container>
        
            <!-- Congiguration Column -->
            <ng-container matColumnDef="run">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                Configuration
              </th>
              <td mat-cell *matCellDef="let task">
                {{task.run?.param?.frequency}} - {{task.run?.param?.threads}}
                <!-- <p>{{task.run?.method}}</p> -->
              </td>
            </ng-container>
        
            <!-- File Column -->
            <ng-container matColumnDef="file">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                File
              </th>
              <td mat-cell *matCellDef="let task">
                {{task.config?.ws_file | lowercase}}
              </td>
            </ng-container>
        
            <!-- Result Column -->
            <ng-container matColumnDef="result">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                Energy
              </th>
              <td mat-cell *matCellDef="let task">
                {{task.meta?.result?.energy}}
              </td>
            </ng-container>
        
            <!-- Time Column -->
            <ng-container matColumnDef="time">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                Time (m:ss:SS)
              </th>
              <td mat-cell *matCellDef="let task">
                {{ (task.meta?.result?.time > 0) ? (task.meta?.result?.time | date: 'mm:ss`SS') : ""}}
              </td>
            </ng-container>

            <!-- Expanded Content Column - 
              The detail row is made up of this one column that spans across all columns -->
            <ng-container matColumnDef="expandedDetail">
              <td mat-cell *matCellDef="let task" [attr.colspan]="displayedColumns.length">
                <div class="example-element-detail" 
                [@detailExpand]="task == focus ? 'expanded' : 'collapsed'" *ngIf="task == focus">
                  <mat-list dense role="list">
                    <mat-list-item role="listitem">
                      <mat-icon>gradient</mat-icon>
                      <span>Method: </span>
                      <span> {{task?.run?.method}}</span>
                    </mat-list-item>
                    <mat-list-item role="listitem">
                      <mat-icon>rowing</mat-icon>
                      <span>Worker:</span>
                      <span>{{task?.meta?.appointment}}</span>
                    </mat-list-item>
                  </mat-list>
                  <mat-list dense role="list">
                    <mat-list-item role="listitem">
                      <mat-icon>list</mat-icon>
                      <span>Accept:</span>
                      <span>{{ (task?.meta?.accept > 0) ? (task.meta?.accept | date: 'EEEE, h:mm:ss`S') : ""}}</span>
                    </mat-list-item>
                    <mat-list-item role="listitem">
                      <mat-icon>directions</mat-icon>
                      <span>Receive:</span>
                      <span>{{ (task?.meta?.receive > 0) ? (task.meta?.receive | date: 'EEEE, h:mm:ss`SS') : ""}}</span>
                    </mat-list-item>
                  </mat-list>
                  <mat-list dense role="list">
                    <mat-list-item role="listitem">
                      <mat-icon>done_all</mat-icon>
                      <span>Reiteration:</span>
                      <span>{{searchTasks([task.run?.param?.frequency, task.run?.param?.threads]).length}}</span>
                    </mat-list-item>
                    <mat-list-item role="listitem">
                      <mat-icon>settings_ethernet</mat-icon>
                      <span>Average energy:</span>
                      <span>{{getAverageResult([task.run?.param?.frequency, task.run?.param?.threads]) | number: '2.1-2'}} </span>
                    </mat-list-item>
                  </mat-list>
                </div>
              </td>
            </ng-container>
        
            <tr mat-header-row *matHeaderRowDef="displayedColumns;"></tr>
            <tr mat-row *matRowDef="let task; columns: displayedColumns;"
              class="example-element-row" 
              [class.example-expanded-row]="focus == task"
              (click)="focus == task ? focus = null : focus = task">
            </tr>
            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
          </table>
          <mat-paginator [pageSizeOptions]="[10, 25, 100]" showFirstLastButtons></mat-paginator>
        </div>

      </mat-card-content>
    </mat-card>  <!-- end results -->

</div>

